{% extends 'base.html' %}
{% load static %}

{% block title %}My Profile - JIT Skill Connect{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/team.css' %}">

<div class="team-list-container">

  <!-- Teams Created by the User -->
  <h2 class="section-title" style="margin-top: 100px;">Teams You Created</h2>
  {% if created_teams %}
    <div class="teams-grid">
      {% for team in created_teams %}
        <div class="team-card">
          <!-- Team Name & Description -->
          <h3 class="team-name">{{ team.name }}</h3>
          <p class="team-desc">{{ team.description|default:"No description" }}</p>

          <!-- Team Leader -->
          <p><strong>Leader:</strong> {{ team.creator.username }}</p>

          <!-- Members Summary -->
          <p>
            <strong>Members:</strong>
            {% if team.members.all %}
              {% for member in team.members.all %}
                {% if forloop.counter <= 3 and member != team.creator %}
                  {{ member.username }}{% if not forloop.last %}, {% endif %}
                {% endif %}
              {% endfor %}
              {% if team.members.count > 3 %}
                ... <a href="{% url 'team_members' team.id %}" class="view-all-link">View All</a>
              {% endif %}
            {% else %}
              No members yet
            {% endif %}
          </p>

          <!-- Actions -->
          <div class="team-actions">
            <a href="{% url 'add_member' team.id %}" class="btn-login">+ Add Member</a>
            <form method="POST" action="{% url 'delete_team' team.id %}" style="display:inline-block; margin-left:10px;">
              {% csrf_token %}
              <button type="submit" class="btn-remove">Delete Team</button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="no-team-msg">You haven’t created any teams yet.</p>
  {% endif %}

  <!-- Teams Joined by the User -->
  <h2 class="section-title">Teams You Joined</h2>
  {% if joined_teams %}
    <div class="teams-grid">
      {% for team in joined_teams %}
        <div class="team-card">
          <h3 class="team-name">{{ team.name }}</h3>
          <p class="team-desc">{{ team.description|default:"No description" }}</p>
          <p><strong>Leader:</strong> {{ team.creator.username }}</p>

          <p>
            <strong>Members:</strong>
            {% if team.members.all %}
              {% for member in team.members.all %}
                {% if forloop.counter <= 3 and member != team.creator %}
                  {{ member.username }}{% if not forloop.last %}, {% endif %}
                {% endif %}
              {% endfor %}
              {% if team.members.count > 3 %}
                 <a href="{% url 'team_members' team.id %}" class="view-all-link">View All</a>
              {% endif %}
            {% else %}
              No members yet
            {% endif %}
          </p>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="no-team-msg">You haven’t joined any teams yet.</p>
  {% endif %}

  <!-- Create New Team Button -->
  <a href="{% url 'create_team' %}" class="btn-login create-team-btn">+ Create New Team</a>

</div>

{% endblock %}