{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invite Members - JIT Skill Connect</title>
  <link rel="stylesheet" href="{% static 'css/add_member.css' %}">
</head>
<body>

  <!-- üåê Navigation -->
  <nav>
    <div class="logo">‚ú® JIT Skill Connect</div>
    <div class="nav-links">
      <a href="{% url 'dashboard' %}">Home</a>
      <a href="{% url 'search_students' %}">Search Students</a>
      <a href="{% url 'my_profile' %}">Profile</a>
      <a href="{% url 'my_teams' %}" class="active">Teams</a>
      <a href="{% url 'invitations_list' %}">Requests</a>
      <a href="{% url 'logout' %}">Logout</a>
    </div>
  </nav>

  <!-- üí¨ Main Section -->
  <section class="invite-section">
    <div class="form-container">
      <h2>Invite Members to <span>"{{ team.name }}"</span></h2>


      <!-- üìä Invitation Summary -->
      <div class="summary-box">
        <h3>üìà Invitation Summary</h3>
        <p><strong>Total Sent:</strong> {{ total_sent }}</p>
        <p class="accepted"><strong>Accepted:</strong> {{ accepted_count }}</p>
        <p class="rejected"><strong>Rejected:</strong> {{ rejected_count }}</p>
      </div>
     {% if invitations %}
        <h3>Invitation Details</h3>
        <ul class="invite-list">
          {% for invite in invitations %}
            <li class="invite-item">
              <strong>{{ invite.receiver.username }}</strong> ‚Äî 
              Status:
              {% if invite.status == 'pending' %}
                <span class="status pending">Pending</span>
              {% elif invite.status == 'accepted' %}
                <span class="status accepted">Accepted ‚úÖ</span>
              {% else %}
                <span class="status rejected">Rejected ‚ùå</span>
              {% endif %}

              {% if invite.status == 'rejected' and invite.reason %}
                <br><em>Reason:</em> {{ invite.reason }}
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="no-invites">No invitations sent yet.</p>
      {% endif %}

      <hr class="divider">

      
      <!-- üîç Search Form -->
      <form method="GET" class="search-form">
        <input type="text" name="q" placeholder="Search student by username or skill..."
               value="{{ query }}">
        <button type="submit" class="btn">Search</button>
      </form>

  
 

      <!-- üë• Search Results -->
      {% if students %}
        <h3>Search Results</h3>
        <ul class="student-list">
          {% for student in students %}
            <li class="student-item">
              {% if student.profile_photo %}
                <img src="{{ student.profile_photo.url }}" alt="{{ student.username }}" class="profile-img">
              {% endif %}

              <div class="student-info">
                <strong>{{ student.username }}</strong> ‚Äî {{ student.branch }}<br>
                <small>
                  Skills:
                  {% for skill in student.skills.all %}
                    {{ skill.name }}{% if not forloop.last %}, {% endif %}
                  {% empty %}
                    No skills
                  {% endfor %}
                </small>
              </div>

              <form method="POST" action="{% url 'add_member' team.id %}">
                {% csrf_token %}
                <input type="hidden" name="student_id" value="{{ student.id }}">
                <button type="submit" class="btn invite-btn">Send Invite</button>
              </form>
            </li>
          {% endfor %}
        </ul>
      {% elif query %}
        <p class="no-results">No students found matching "<strong>{{ query }}</strong>".</p>
      {% endif %}
    </div>
  </section>

  <footer>¬© 2025 JIT
